<head>
   <title>Ideala</title>
   <link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
   <meta charset="utf-8">
    <link rel="apple-touch-icon" href="//mindmup.s3.amazonaws.com/lib/img/apple-touch-icon.png" />
    <link rel="shortcut icon" href="http://mindmup.s3.amazonaws.com/lib/img/favicon.ico" >
    <link href="http://twitter.github.com/bootstrap/assets/js/google-code-prettify/prettify.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/3.0.2/css/font-awesome.css" rel="stylesheet">
    <script src="https://mindmup.s3.amazonaws.com/lib/jquery.hotkeys.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/google-code-prettify/prettify.js"></script>
</head>

<body>
   {{>navigation}}
   {{> main }}
</body>

 <!-- Barra de navegacion-->
<template name="navigation">
  <header>
          <div class="container">
            <h1><a href="{{pathFor 'welcome'}}">Ideala</a></h1>
              <nav>
                <ul>
                  <li><a href="{{pathFor 'ideas'}}">Ideas</a></li>
                  <li><a  href="{{pathFor 'people'}}">Personas</a></li>
                  {{#if currentUser}}
                    <li>{{>theUser}}</li>
                    <li><a href="#logout" class="tryLogout" id="salir">Salir</a></li>
                  {{else}}
                    <li><a href="{{pathFor 'loginForm'}}" id="ingresar">Ingresar</a></li>
                  {{/if}}
                </ul>
              </nav>
          </div>
  </header>
</template>

<template name="main">
  {{#if currentUser}}
    {{>newIdea}}
  {{/if}}
  {{#if showSimilarIdeas}}
      {{>similar_ideas}}
  {{/if}}
</template>

  <!-- Seccion:"Welcome"-->
<template name="welcome">
  <div class="wpage">
  {{#if currentUser}}
    {{>ideas}}
  {{else}}
        {{>welcomeMessage}}
  {{/if}}
  </div>
</template>

<template name="welcomeMessage">
    <h1>Ideala</h1>
    <p>Guarda una idea, observa cómo crece</p>
    <br>
    {{>newIdea}}
</template>

<template name="newIdea">
  <form method="post" action="index.html">
        <label>¿Cuál es tu idea?</label>
        <p><textarea type="text" id="idea">{{ideaData.idea}}</textarea></p>
        <label>Palabras clave de tu idea separadas por coma</label>
        <p><input type="text" name="typeOfIdea" id="tagsOfIdea" value={{ideaData.tagsOfIdea}}></p>
        <p class="submit"><input type="submit"  class="searchIdea" value="Añadir Idea"></p>    
  </form>
</template>

<template name="similar_ideas">
  <section class="container">
  <div class="perfilIdeas">
  <h2>Ideas similares</h2>
  <p class="submit"><input type="submit"  class="saveIdea" value="Mi idea es diferente"></p>
  </div>
  </section>
  {{#each matching_idea}}
  <section class="container">
  <div class="perfilIdeas">
      {{>idea}}
  </div>
  </section>
  {{else}}
  <h3>No se encontraron ideas similares</h3>
  {{/each}}
</template>

<template name="ideas">
  {{#each open_idea}}
  <section class="container">
  <div class="perfilIdeas">
      {{>idea}}
  </div>
  </section>
  {{/each}}
</template>

<template name="people">
  <section class="container">
  {{#each user}}
    <div class="perfilIdeas">
    <span class="person" title="Ver perfil">
      {{profile.points}} {{profile.firstName}} {{profile.lastName}}
      {{#each profile.roles}}
        {{this}}
      {{/each}}
    </span><br>
    </div>
  {{/each}}
  </section>
</template>

<!-- Seccion:"LogInForm"-->
<template name="loginForm">
  <section class="container">
          <div class="login">
                <h1>Inicia Sesión </h1>
                  <form method="post" action="index.html">
                    <a href=""><img src="loginfacebook.png"></a>
                    <a href="{{pathFor 'newUserForm'}}">Crear una cuenta</a>
                    <p><input type="text" id="username" name="username" placeholder="Usuario"></p>
                    <p><input type="password" id="password" name="password" value="" placeholder="Contraseña"></p>
                    <p class="remember_me">
                      <label>
                          <input type="checkbox" name="remember_me" id="remember_me">
                           Recordar en esta computadora
                        </label>
                    </p>
                    <p class="submit"><input type="submit" class="tryLogin" id="submitBoton" name="commit" value="Entrar"></p>
                    <div class="login-help">
              <p>¿Olvidaste tu contraseña? <a href="index.html">Haz clic aquí para resetearla</a>.</p>
          </div>
        </form>
          </div>
      </section>
</template>

<!-- Seccion:"newUserForm"-->
<template name="newUserForm">
  <section>
    <div class="userR">
      <h1>Nuevo usuario</h1>
      <form name="newUserForm">
        <p><input type="text" class="form-control" id="firstName" placeholder="Nombre"></p>
        <p><input type="text" class="form-control" id="lastName" placeholder="Apellido"></p>
        <p><input type="text" class="form-control" id="username" placeholder="Usuario"></p>
        <p><input type="text" class="form-control" id="email" placeholder="Correo Electrónico"></p>
        <p><input type="password" class="form-control" id="password" placeholder="Contraseña"></p>
        <p><label>¿Qué roles te gusta realizar en un proyecto?</label><br>
        <input type="checkbox" name="role" value="administración">Administrarlo<br>
        <input type="checkbox" name="role" value="desarrollo">Desarrollarlo (Parte técnica)<br>
        <input type="checkbox" name="role" value="diseño">Diseñarlo<br>
        <input type="checkbox" name="role" value="ventas">Venderlo<br>
        <input type="checkbox" name="role" value="marketing">Difundirlo/promocionarlo<br>
        <input type="checkbox" name="role" value="inversionista">Financearlo<br>
        </p>
        <input type="checkbox" name="role" value="mentoría">Mentoría<br>
        <p class="submit"><input id="submitBoton" class="createUser" type="submit" name="commit" value="Registrarse"></p>
        </form>
    </div>
  </section>
</template>

<template name="idea">
  <span>
    <a href="{{pathFor 'ideaData'}}">
      <p id="descriptionIdea">{{idea}}</p>
      <p id="descriptionIdea">{{tagsOfIdea}}</p>
    </a>
  </span>
</template>

<template name="persons">
    {{#each peopleInvolved.users}}
      {{#each user this}}
        <span class="person" title="Ver perfil">
        <p>{{profile.firstName}} {{profile.lastName}} </p>
        </span>
      {{/each}}
      {{#if canEdit this currentUser._id}}
        <input type="submit"  class="copyIdea" value="Keep it">
      {{/if}}
    {{/each}}
</template>

<template name="profile">
    {{#each user}}
    <section class="container">
      <div class="perfilUsuario">
        <h1>{{profile.firstName}} {{profile.lastName}} {{profile.points}}</h1>
        <p id="titulos">Ideas</p>
        <div id="pProyectos">
        {{#each profile.ideas}}
          {{#each idea_data this}}
              <div id="sectionProyectos">
              <span class="seeIdea" title="Ver Idea"><p>{{idea}} </p></span>
              </div>
          {{/each}}
        {{/each}}
      </div>
        <p id="titulos">Ideas de Mejora</p>
        <div id="pProyectos">
        {{#each profile.relatedIdeas}}
          {{#each related_data this}}
              <div id="sectionProyectos">
              <span class="seeIdea" title="Ver Idea"><p>{{idea}} </p>
              <p>{{points}}</p>
              </span>
              </div>
          {{/each}}
        {{/each}}
        </div>
      </div>
    </section>
    {{/each}}
</template>
<template name="ideaData">
    {{#each idea_to_show}}
    <section class="container">
        <p>{{idea}}</p>
        <p>{{tagsOfIdea}}</p>
        {{>persons}}
         <p class="submit"><input type="submit"  class="copyIdea" value="Guardar esta idea"></p>
        {{#if video}}
        {{>video}}
        {{/if}}
        {{>wysiwyg}}
        <h2>Comentarios</h2>
        {{#each relatedIdeas.ideas}}
          {{#each idea_data this}}
              <p>{{idea}}</p>
              <img src="up.png" height="42" width="42" class="increase"><p>{{points}}</p><img src="down.png" height="42" width="42" class="decrease">
              {{>persons}}
          {{/each}}
        {{/each}}
    </section>
    {{/each}}
</template>
<template name="video">
<!--Forma en que se da el link normalmente y cualquier mortal lo entiende 

http://vimeo.com/91333666
http://youtu.be/EipGZpAUBws
-->  
<iframe width="420" height="315" src="//www.youtube.com/embed/EipGZpAUBws" frameborder="0" allowfullscreen></iframe>
<!-- <iframe width="420" height="315" src="//player.vimeo.com/video/91333666" frameborder="0" allowfullscreen></iframe>
 -->
</template>
<template name="theUser">
{{#each user}}
  <a href="{{pathFor 'profile'}}">
  {{profile.firstName}}
  </a>
{{/each}}
</template>
<!--Por ahora no se usa, hay que ver de que manera usamos el de new idea para guardar esto -->
<template name="newRelatedIdea">
  <form method="post" action="index.html">
        <label>¿Cuál es tu idea?</label>
        <p><textarea type="text" id="idea">{{ideaData.idea}}</textarea></p>
        <label>Palabras clave de tu idea separadas por coma</label>
        <p><input type="text" name="typeOfIdea" id="tagsOfIdea" value={{ideaData.tagsOfIdea}}></p>
        <p class="submit"><input type="submit"  class="saveRelated" value="Añadir Idea"></p>    
  </form>
</template>
<template name="wysiwyg">
  <div id="alerts"></div>
  <div class="btn-toolbar" data-role="editor-toolbar" data-target="#editor">
      <div class="btn-group">
        <a class="btn dropdown-toggle" data-toggle="dropdown" title="Font"><i class="icon-font"></i><b class="caret"></b></a>
          <ul class="dropdown-menu">
          </ul>
        </div>
      <div class="btn-group">
        <a class="btn dropdown-toggle" data-toggle="dropdown" title="Font Size"><i class="icon-text-height"></i>&nbsp;<b class="caret"></b></a>
          <ul class="dropdown-menu">
          <li><a data-edit="fontSize 5"><font size="5">Huge</font></a></li>
          <li><a data-edit="fontSize 3"><font size="3">Normal</font></a></li>
          <li><a data-edit="fontSize 1"><font size="1">Small</font></a></li>
          </ul>
      </div>
      <div class="btn-group">
        <a class="btn" data-edit="bold" title="Bold (Ctrl/Cmd+B)"><i class="icon-bold"></i></a>
        <a class="btn" data-edit="italic" title="Italic (Ctrl/Cmd+I)"><i class="icon-italic"></i></a>
        <a class="btn" data-edit="strikethrough" title="Strikethrough"><i class="icon-strikethrough"></i></a>
        <a class="btn" data-edit="underline" title="Underline (Ctrl/Cmd+U)"><i class="icon-underline"></i></a>
      </div>
      <div class="btn-group">
        <a class="btn" data-edit="insertunorderedlist" title="Bullet list"><i class="icon-list-ul"></i></a>
        <a class="btn" data-edit="insertorderedlist" title="Number list"><i class="icon-list-ol"></i></a>
        <a class="btn" data-edit="outdent" title="Reduce indent (Shift+Tab)"><i class="icon-indent-left"></i></a>
        <a class="btn" data-edit="indent" title="Indent (Tab)"><i class="icon-indent-right"></i></a>
      </div>
      <div class="btn-group">
        <a class="btn" data-edit="justifyleft" title="Align Left (Ctrl/Cmd+L)"><i class="icon-align-left"></i></a>
        <a class="btn" data-edit="justifycenter" title="Center (Ctrl/Cmd+E)"><i class="icon-align-center"></i></a>
        <a class="btn" data-edit="justifyright" title="Align Right (Ctrl/Cmd+R)"><i class="icon-align-right"></i></a>
        <a class="btn" data-edit="justifyfull" title="Justify (Ctrl/Cmd+J)"><i class="icon-align-justify"></i></a>
      </div>
      <div class="btn-group">
<a class="btn dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="icon-link"></i></a>
<div class="dropdown-menu input-append">
<input class="span2" placeholder="URL" type="text" data-edit="createLink"/>
<button class="btn" type="button">Add</button>
        </div>
        <a class="btn" data-edit="unlink" title="Remove Hyperlink"><i class="icon-cut"></i></a>

      </div>
      
      <div class="btn-group">
        <a class="btn" title="Insert picture (or just drag & drop)" id="pictureBtn"><i class="icon-picture"></i></a>
        <input type="file" data-role="magic-overlay" data-target="#pictureBtn" data-edit="insertImage" />
      </div>
      <div class="btn-group">
        <a class="btn" data-edit="undo" title="Undo (Ctrl/Cmd+Z)"><i class="icon-undo"></i></a>
        <a class="btn" data-edit="redo" title="Redo (Ctrl/Cmd+Y)"><i class="icon-repeat"></i></a>
      </div>
      <input type="text" data-edit="inserttext" id="voiceBtn" x-webkit-speech="">
    </div>

    <div id="editor">
      Go ahead&hellip;
    </div>
    <script>
  $(function(){
    function initToolbarBootstrapBindings() {
      var fonts = ['Serif', 'Sans', 'Arial', 'Arial Black', 'Courier',
            'Courier New', 'Comic Sans MS', 'Helvetica', 'Impact', 'Lucida Grande', 'Lucida Sans', 'Tahoma', 'Times',
            'Times New Roman', 'Verdana'],
            fontTarget = $('[title=Font]').siblings('.dropdown-menu');
      $.each(fonts, function (idx, fontName) {
          fontTarget.append($('<li><a data-edit="fontName ' + fontName +'" style="font-family:\''+ fontName +'\'">'+fontName + '</a></li>'));
      });
      $('a[title]').tooltip({container:'body'});
     $('.dropdown-menu input').click(function() {return false;})
.change(function () {$(this).parent('.dropdown-menu').siblings('.dropdown-toggle').dropdown('toggle');})
        .keydown('esc', function () {this.value='';$(this).change();});

      $('[data-role=magic-overlay]').each(function () {
        var overlay = $(this), target = $(overlay.data('target'));
        overlay.css('opacity', 0).css('position', 'absolute').offset(target.offset()).width(target.outerWidth()).height(target.outerHeight());
      });
      if ("onwebkitspeechchange" in document.createElement("input")) {
        var editorOffset = $('#editor').offset();
        $('#voiceBtn').css('position','absolute').offset({top: editorOffset.top, left: editorOffset.left+$('#editor').innerWidth()-35});
      } else {
        $('#voiceBtn').hide();
      }
};
function showErrorAlert (reason, detail) {
var msg='';
if (reason==='unsupported-file-type') { msg = "Unsupported format " +detail; }
else {
console.log("error uploading file", reason, detail);
}
$('<div class="alert"> <button type="button" class="close" data-dismiss="alert">&times;</button>'+
'<strong>File upload error</strong> '+msg+' </div>').prependTo('#alerts');
};
initToolbarBootstrapBindings();
$('#editor').wysiwyg({ fileUploadError: showErrorAlert} );
    window.prettyPrint && prettyPrint();
  });
</script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="http://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</template>
<template name="wysiwyg2">
  <textarea id="editor" placeholder="Enter text ..."></textarea>
  <script type="text/javascript">
    $('#editor').wysihtml5();
  </script>
</template>